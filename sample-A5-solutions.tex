\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{geometry}
\usepackage{enumitem}

\geometry{margin=1in}
\setlength{\parindent}{0pt}

\title{CS 338 Fun Assignment \#5 - Solutions}
\author{}
\date{}

\begin{document}

\maketitle

\section*{Question 1.}

\textbf{(a) Solution:}
READ COMMITTED. 1 read 1 write, no dirty reads.

\textbf{(b) Solution:}
REPEATABLE READ. 2 reads, read only, no dirty reads; Phantom allowed as not writing.

\textbf{(c) Solution:}
SERIALIZABLE. 3 reads, 1 write, no dirty reads.

\newpage
\section*{Question 2}
\textbf{(a) Solution:}\\ 
An \textbf{unrepeatable read} occurs when Transaction reads the same row twice and 
obtains different values because another committed transaction modified that row between
reads (e.g., READ COMMITTED allows this). \\

A \textbf{phantom read} occurs when Transaction executes the same \texttt{SELECT} that 
retrieves a \emph{set} of rows twice and finds that new rows have been inserted or existing rows 
ahs been deleted (e.g., REPEATABLE READ allows this, SERIALIZABLE blocks it).\\

\textbf{(b) Solution:}\\
Benefits:
\begin{itemize}[nosep]
  \item Speeds up foreign‚Äêkey joins without requiring full table scans (q3 part b is an example).
  \item Fast look up for selective queries (binary search with \(\log(\#row)\) time).
\end{itemize}

Problems:
\begin{itemize}[nosep]
  \item Every INSERT, UPDATE, or DELETE triggers index maintenance. 
\end{itemize}


\newpage
\section*{Question 3.}

\textbf{(a) Solution:}\\

\textbf{Minimum isolation level: SERIALIZABLE:} 2 read 2 write, no phantoms allowed. 1 read in 
\texttt{SELECT}, 1 read and 1 write in \texttt{UPDATE}, 1 write in \texttt{INSERT}\\
 
\textbf{(b) Solution:}\\

\textbf{T1:}
\begin{itemize}
    \item \texttt{CREATE UNIQUE INDEX idx\_book\_isbn ON Book(isbn);}
\end{itemize}

\textbf{T2:}

\begin{itemize}
    \item \texttt{CREATE INDEX idx\_checkout\_composite ON Checkout(member\_id, 
    returned\_date, isbn);}
    \item Database can find all unreturned checkouts for member 12345 using only the 
    index then find \texttt{returned\_date IS NULL}, then joins with Book using the ISBN values 
    directly from the index.
\end{itemize}

\end{document}
